<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å–®å­—å¡å­¸ç¿’ç¨‹å¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', 'Inter', sans-serif;
            touch-action: manipulation; /* ç¦ç”¨é›™æ“Šç¸®æ”¾ */
        }
        .card {
            /* å­—é«”å¤§å°ç¾åœ¨ç”± JavaScript æ§åˆ¶ */
            line-height: 1.2;
            overflow-wrap: break-word;
            word-break: break-word;
        }
        .card .placeholder { display: block; }
        .card .content { display: none; }
        .card.revealed .placeholder { display: none; }
        .card.revealed .content { display: block; }
        button, .card, #main-screen {
            -webkit-tap-highlight-color: transparent;
        }
        #menu-panel {
            transition: transform 0.3s ease-in-out;
        }
        #menu-panel.closed { transform: translateX(-100%); }
        #menu-panel.open { transform: translateX(0); }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 flex items-center justify-center min-h-screen p-2 sm:p-4">

    <div id="app" class="w-full max-w-6xl mx-auto">

        <!-- ä¸Šå‚³ç•«é¢ -->
        <div id="upload-screen" class="text-center p-8 bg-white dark:bg-gray-800 rounded-2xl shadow-lg">
            <h1 class="text-3xl font-bold mb-4 text-gray-900 dark:text-white">å–®å­—å¡å­¸ç¿’ç¨‹å¼</h1>
            <p class="mb-6 text-gray-600 dark:text-gray-300">è«‹ä¸Šå‚³æ‚¨çš„ .txt å–®å­—æª”ã€‚<br>æª”æ¡ˆå…§å®¹æ‡‰ä»¥åˆ†è™Ÿ (;) åˆ†éš”ï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€çµ„å¡ç‰‡ã€‚</p>
            <div class="flex items-center justify-center w-full">
                <label for="file-upload" class="flex flex-col items-center justify-center w-full h-48 border-2 border-gray-300 dark:border-gray-600 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:hover:border-gray-500 dark:hover:bg-gray-600 transition-colors">
                    <div class="flex flex-col items-center justify-center pt-5 pb-6">
                        <svg class="w-10 h-10 mb-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 16"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"/></svg>
                        <p class="mb-2 text-sm text-gray-500 dark:text-gray-400"><span class="font-semibold">é»æ“Šæ­¤è™•ä¸Šå‚³</span> æˆ–æ‹–æ›³æª”æ¡ˆè‡³æ­¤</p>
                        <p class="text-xs text-gray-500 dark:text-gray-400">åƒ…é™ .txt æª”æ¡ˆ</p>
                    </div>
                    <input id="file-upload" type="file" class="hidden" accept=".txt">
                </label>
            </div>
             <div class="mt-4 text-gray-500 dark:text-gray-400">æˆ–</div>
            <div class="mt-4 flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2">
                <select id="example-selector" class="block w-full px-4 py-3 text-base border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-600 focus:outline-none focus:ring-teal-500 focus:border-teal-500 rounded-lg">
                    <option value="" disabled selected>--- é¸æ“‡ä¸€å€‹å…§å»ºç¯„ä¾‹ ---</option>
                    <option value="verbs">ç¯„ä¾‹ä¸€ï¼šå‹•è©ä¸‰æ…‹</option>
                    <option value="elements">ç¯„ä¾‹äºŒï¼šå…ƒç´ é€±æœŸè¡¨</option>
                    <option value="capitals">ç¯„ä¾‹ä¸‰ï¼šåœ‹å®¶èˆ‡é¦–éƒ½</option>
                </select>
                <button id="load-selected-example-btn" class="px-6 py-3 bg-teal-500 text-white font-semibold rounded-lg shadow-md hover:bg-teal-600 transition-colors whitespace-nowrap">è¼‰å…¥ç¯„ä¾‹</button>
            </div>
            <div id="error-message" class="mt-4 text-red-500 font-semibold"></div>
        </div>

        <!-- ä¸»å­¸ç¿’ç•«é¢ -->
        <div id="main-screen" class="hidden w-full h-[95vh] flex flex-col bg-gray-200 dark:bg-gray-800 rounded-2xl shadow-lg p-2 relative overflow-hidden">
            <div id="card-area" class="flex-grow flex items-center justify-center w-full h-full">
                <div id="card-container" class="grid gap-2 w-full h-full">
                    <!-- å¡ç‰‡å°‡æœƒå‹•æ…‹ç”Ÿæˆæ–¼æ­¤ -->
                </div>
            </div>
            <!-- æ§åˆ¶æŒ‰éˆ•å€ -->
            <div class="absolute bottom-4 left-4 right-4 flex justify-between items-center space-x-2">
                <button id="prev-btn" class="px-4 py-3 bg-gray-300 dark:bg-gray-600 rounded-full shadow-md hover:bg-gray-400 dark:hover:bg-gray-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all transform hover:scale-105"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg></button>
                <div class="flex space-x-4">
                    <button id="incorrect-btn" class="w-16 h-16 sm:w-20 sm:h-20 flex items-center justify-center text-4xl bg-red-500 text-white rounded-full shadow-lg hover:bg-red-600 transition-all transform hover:scale-110">âŒ</button>
                    <button id="correct-btn" class="w-16 h-16 sm:w-20 sm:h-20 flex items-center justify-center text-4xl bg-green-500 text-white rounded-full shadow-lg hover:bg-green-600 transition-all transform hover:scale-110">âœ…</button>
                </div>
                <button id="next-btn" class="px-4 py-3 bg-gray-300 dark:bg-gray-600 rounded-full shadow-md hover:bg-gray-400 dark:hover:bg-gray-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all transform hover:scale-105"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg></button>
            </div>
            <!-- é ‚éƒ¨ UI -->
            <div class="absolute top-4 left-4 right-4 flex justify-between items-center">
                <button id="menu-btn" class="p-2 bg-gray-300 dark:bg-gray-700 rounded-full shadow-md hover:bg-gray-400 dark:hover:bg-gray-600 transition-colors z-30"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg></button>
                <div id="deck-info" class="text-sm font-medium bg-gray-300 dark:bg-gray-700 px-3 py-1 rounded-full"></div>
            </div>
            <div id="history-alert" class="hidden absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-yellow-500 text-white px-6 py-3 rounded-lg shadow-xl text-center z-40"><p>ç„¡æ³•å†è¿”å›ï¼</p><p class="text-sm">ï¼ˆæœ€å¤šä¿ç•™20çµ„æ­·å²ç´€éŒ„ï¼‰</p></div>

            <!-- é¸å–®é¢æ¿ -->
            <div id="menu-overlay" class="hidden absolute inset-0 bg-black bg-opacity-50 z-10"></div>
            <div id="menu-panel" class="closed absolute top-0 left-0 h-full w-72 bg-white dark:bg-gray-800 shadow-lg z-20 p-4 flex flex-col">
                <div class="flex justify-between items-center mb-6"><h2 class="text-xl font-bold">é¸å–®</h2><button id="close-menu-btn" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg></button></div>
                
                <div class="flex-grow">
                    <ul class="space-y-2">
                        <li><button id="show-all-btn" class="w-full text-left px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">ğŸ“„ é¡¯ç¤ºæ‰€æœ‰å¡ç‰‡</button></li>
                        <li><button id="toggle-layout-btn" class="w-full text-left px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">ğŸ”ƒ åˆ‡æ›æ’åˆ—æ–¹å‘</button></li>
                        <li><button id="toggle-auto-reveal-btn" class="w-full text-left px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">â–¶ï¸ è‡ªå‹•ç¿»é–‹é¦–å¼µï¼š<span class="font-bold text-red-500">é—œ</span></button></li>
                        <!-- å­—å‹å¤§å°èª¿æ•´ -->
                        <li class="w-full text-left px-4 py-2 flex items-center justify-between text-gray-800 dark:text-gray-200">
                            <span class="mr-2">ğŸ…°ï¸ å¤§å°</span>
                            <div class="flex items-center space-x-2">
                                <button id="font-size-decrease" class="px-3 py-1 bg-gray-200 dark:bg-gray-600 rounded-md hover:bg-gray-300 dark:hover:bg-gray-500 font-bold">-</button>
                                <span id="font-size-value" class="w-16 text-center text-sm">é è¨­</span>
                                <button id="font-size-increase" class="px-3 py-1 bg-gray-200 dark:bg-gray-600 rounded-md hover:bg-gray-300 dark:hover:bg-gray-500 font-bold">+</button>
                            </div>
                        </li>
                        <li><button id="how-to-use-btn" class="w-full text-left px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">â” ä½¿ç”¨æ•™å­¸</button></li>
                    </ul>
                </div>
                
                <div class="mt-auto border-t pt-2 border-gray-200 dark:border-gray-700">
                     <ul class="space-y-2">
                        <li><button id="open-new-btn" class="w-full text-left px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">ğŸ“‚ é–‹å•Ÿæ–°æª”/ç¯„ä¾‹</button></li>
                        <li><button id="download-btn" class="w-full text-left px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">ğŸ’¾ ä¸‹è¼‰å­¸ç¿’ç´€éŒ„</button></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- æ‰€æœ‰å¡ç‰‡åˆ—è¡¨ Modal -->
    <div id="all-cards-modal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-30"><div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-4xl h-[90vh] flex flex-col"><div class="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"><h2 class="text-xl font-bold">æ‰€æœ‰å¡ç‰‡</h2><button id="close-modal-btn" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg></button></div><div class="flex-grow overflow-y-auto p-4"><table id="all-cards-table" class="w-full text-left"></table></div></div></div>
    
    <!-- ä¸‹è¼‰æ ¼å¼é¸æ“‡ Modal -->
    <div id="download-modal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-40">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-sm">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"><h2 class="text-xl font-bold">é¸æ“‡ä¸‹è¼‰æ ¼å¼</h2><button id="close-download-modal-btn" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg></button></div>
            <div class="p-4 grid grid-cols-2 gap-4">
                <button data-format="csv" class="download-format-btn px-4 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">CSV</button>
                <button data-format="txt" class="download-format-btn px-4 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">TXT</button>
            </div>
        </div>
    </div>

    <!-- ä½¿ç”¨æ•™å­¸ Modal -->
    <div id="how-to-use-modal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-30">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-2xl h-auto max-h-[90vh] flex flex-col">
            <div class="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                <h2 class="text-xl font-bold">ä½¿ç”¨æ•™å­¸</h2>
                <button id="close-how-to-use-modal-btn" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <!-- æ‚¨å¯ä»¥åœ¨æ­¤è™•ä¿®æ”¹æ•™å­¸å…§å®¹ -->
            <div class="flex-grow overflow-y-auto p-6 space-y-4 text-gray-700 dark:text-gray-300">
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">ç¨‹å¼ç¸½è¦½</h3>
                <p>é€™æ˜¯ä¸€ä»½é‡å°ä½ æä¾›çš„ã€Œå–®å­—å¡å­¸ç¿’ç¨‹å¼ã€çš„è©³ç´°ä½¿ç”¨æ•™å­¸ã€‚é€™æ¬¾ç¨‹å¼èƒ½è®“ä½ ä¸Šå‚³è‡ªè£½çš„å–®å­—æª”æ¡ˆï¼Œä¸¦é€éå–®å­—å¡æ¨¡å¼ä¾†é€²è¡Œå­¸ç¿’èˆ‡æ¸¬é©—ã€‚</p>
                <ul class="list-disc list-inside space-y-2">
                    <li><strong>ä¸Šå‚³ç•«é¢ï¼š</strong>ç”¨ä¾†è¼‰å…¥ä½ çš„å–®å­—æª”æ¡ˆï¼Œæˆ–é¸æ“‡å…§å»ºçš„ç¯„ä¾‹ã€‚</li>
                    <li><strong>ä¸»å­¸ç¿’ç•«é¢ï¼š</strong>å–®å­—å¡å­¸ç¿’å’Œæ“ä½œçš„ä¸»è¦ä»‹é¢ã€‚</li>
                </ul>

                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">ä¸€ã€æª”æ¡ˆæº–å‚™èˆ‡å¡ç‰‡è¼‰å…¥</h3>
                <ul class="list-disc list-inside space-y-2">
                    <li><strong>ğŸ“ æª”æ¡ˆæ ¼å¼</strong>
                        <ul class="list-circle list-inside ml-4">
                            <li>ä½ éœ€è¦ä¸€å€‹ <strong>.txt</strong> æ–‡å­—æª”ï¼Œä¸¦éµå¾ªä»¥ä¸‹æ ¼å¼ï¼š
                                <ul class="list-square list-inside ml-4">
                                    <li>æ¯çµ„å–®å­—å¡ä½”ç”¨ä¸€è¡Œã€‚</li>
                                    <li>å¡ç‰‡ä¸Šçš„æ¯å€‹å…§å®¹ï¼ˆæ¬„ä½ï¼‰ä¹‹é–“ä»¥ <strong>åˆ†è™Ÿ (;)</strong> åˆ†éš”ã€‚</li>
                                    <li>ä¾‹å¦‚ï¼š<code>å–®å­—;ç™¼éŸ³;è§£é‡‹</code> æˆ– <code>ä¸­æ–‡;è‹±æ–‡</code>ã€‚</li>
                                    <li>ä½ å¯ä»¥åœ¨ä»»ä½•æ¬„ä½ä¸­ä½¿ç”¨ <strong>é›™æ–œç·š (//)</strong> ä¾†æ›è¡Œï¼Œä¾‹å¦‚ï¼š<code>å‹•è©;to learn//learned//learned</code>ã€‚</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li><strong>ğŸ“ è¼‰å…¥æ–¹å¼</strong>
                        <ul class="list-circle list-inside ml-4">
                            <li><strong>ä¸Šå‚³æª”æ¡ˆï¼š</strong>é»æ“Šã€Œé»æ“Šæ­¤è™•ä¸Šå‚³ã€å€åŸŸï¼Œæˆ–å°‡ä½ çš„ <strong>.txt</strong> æª”æ‹–æ›³åˆ°è©²å€åŸŸã€‚</li>
                            <li><strong>è¼‰å…¥ç¯„ä¾‹ï¼š</strong>è‹¥æ²’æœ‰æª”æ¡ˆï¼Œä½ å¯ä»¥å¾ä¸‹æ‹‰é¸å–®ä¸­é¸æ“‡å…§å»ºçš„ç¯„ä¾‹ï¼Œç„¶å¾Œé»æ“Šã€Œè¼‰å…¥ç¯„ä¾‹ã€ã€‚</li>
                        </ul>
                    </li>
                </ul>

                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">äºŒã€ä¸»å­¸ç¿’ç•«é¢æ“ä½œ</h3>
                <p>æˆåŠŸè¼‰å…¥æª”æ¡ˆå¾Œï¼Œç¨‹å¼æœƒåˆ‡æ›åˆ°ä¸»å­¸ç¿’ç•«é¢ï¼Œè®“ä½ é–‹å§‹å­¸ç¿’ã€‚</p>
                <ul class="list-disc list-inside space-y-2">
                    <li><strong>ğŸƒ å–®å­—å¡æ“ä½œ</strong>
                        <ul class="list-circle list-inside ml-4">
                            <li><strong>ç¿»é–‹å¡ç‰‡ï¼š</strong>é»æ“Šå¡ç‰‡ï¼Œå¡ç‰‡ä¸Šçš„å…§å®¹æœƒå¾ã€Œå•è™Ÿã€è®Šæˆç­”æ¡ˆã€‚</li>
                            <li><strong>ä¸‹ä¸€å¼µï¼š</strong>åœ¨ç•«é¢ä»»ä¸€è™•é»æ“Šï¼ˆé™¤äº†å¡ç‰‡æœ¬èº«å’ŒæŒ‰éˆ•ï¼‰ï¼Œæœƒè‡ªå‹•è·³åˆ°ä¸‹ä¸€å¼µå¡ç‰‡ã€‚</li>
                        </ul>
                    </li>
                    <li><strong>ç­”å°ï¼ç­”éŒ¯</strong>
                        <ul class="list-circle list-inside ml-4">
                            <li>é»æ“Šå³ä¸‹è§’çš„ <strong>âœ…</strong>ï¼Œè¡¨ç¤ºä½ ç­”å°äº†é€™å¼µå¡ç‰‡ã€‚ç­”å°çš„å¡ç‰‡æœƒå¾å¾…å­¸ç¿’åˆ—è¡¨ä¸­ç§»é™¤ï¼Œç›´åˆ°ä½ å­¸å®Œæ‰€æœ‰å¡ç‰‡ç‚ºæ­¢ã€‚</li>
                            <li>é»æ“Šå·¦ä¸‹è§’çš„ <strong>âŒ</strong>ï¼Œè¡¨ç¤ºä½ ç­”éŒ¯äº†ã€‚ç­”éŒ¯çš„å¡ç‰‡æœƒç¹¼çºŒç•™åœ¨å¾…å­¸ç¿’åˆ—è¡¨ï¼Œä¸‹æ¬¡é‚„æœ‰æ©Ÿæœƒå†æ¬¡æŠ½åˆ°ã€‚</li>
                        </ul>
                    </li>
                    <li><strong>ğŸ”„ å°èˆªèˆ‡ç´€éŒ„</strong>
                        <ul class="list-circle list-inside ml-4">
                            <li><strong>å›åˆ°ä¸Šä¸€å¼µï¼š</strong>é»æ“Šå·¦ä¸‹è§’çš„ <strong>ã€Š</strong> æŒ‰éˆ•ï¼Œå¯ä»¥è¿”å›ä¸Šä¸€å¼µå¡ç‰‡ã€‚</li>
                            <li><strong>è·³åˆ°ä¸‹ä¸€å¼µï¼š</strong>é»æ“Šå³ä¸‹è§’çš„ <strong>ã€‹</strong> æŒ‰éˆ•ï¼Œå¯ä»¥ä¸è©•åˆ†ç›´æ¥è·³åˆ°ä¸‹ä¸€å¼µå¡ç‰‡ã€‚</li>
                            <li><strong>æ­·å²ç´€éŒ„ï¼š</strong>ç¨‹å¼æœ€å¤šæœƒä¿ç•™ <strong>20 çµ„</strong> å¡ç‰‡æ­·å²ç´€éŒ„ï¼Œæ–¹ä¾¿ä½ éš¨æ™‚å›é¡§ã€‚</li>
                        </ul>
                    </li>
                </ul>

                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">ä¸‰ã€é¸å–®åŠŸèƒ½</h3>
                <p>é»æ“Šå·¦ä¸Šè§’çš„ <strong>â˜°</strong> åœ–ç¤ºï¼Œæœƒå½ˆå‡ºåŠŸèƒ½é¸å–®ã€‚</p>
                <ul class="list-disc list-inside space-y-2">
                    <li><strong>ğŸ“„ é¡¯ç¤ºæ‰€æœ‰å¡ç‰‡ï¼š</strong>é–‹å•Ÿä¸€å€‹æ–°è¦–çª—ï¼Œé¡¯ç¤ºæ‰€æœ‰å¡ç‰‡åŠå…¶å­¸ç¿’ç‹€æ…‹ï¼ˆâœ… ç­”å°ã€âŒ ç­”éŒ¯ã€â¬œ æœªå­¸ç¿’ï¼‰ã€‚</li>
                    <li><strong>ğŸ”ƒ åˆ‡æ›æ’åˆ—æ–¹å‘ï¼š</strong>åˆ‡æ›å¤šæ¬„ä½å¡ç‰‡çš„æ’åˆ—æ–¹å¼ï¼Œå¯ä»¥åœ¨ <strong>æ°´å¹³</strong> å’Œ <strong>å‚ç›´</strong> ä¹‹é–“åˆ‡æ›ã€‚</li>
                    <li><strong>â–¶ï¸ è‡ªå‹•ç¿»é–‹é¦–å¼µï¼š</strong>é–‹å•Ÿæˆ–é—œé–‰é€™å€‹é¸é …ã€‚ç•¶é–‹å•Ÿæ™‚ï¼Œæ¯æ¬¡è¼‰å…¥æ–°å¡ç‰‡ï¼Œç¬¬ä¸€å€‹æ¬„ä½æœƒè‡ªå‹•ç¿»é–‹ã€‚</li>
                    <li><strong>ğŸ…°ï¸ å¤§å°ï¼š</strong>èª¿æ•´<strong>å¡ç‰‡ä¸Š</strong>é¡¯ç¤ºçš„å­—å‹å¤§å°ã€‚</li>
                    <li><strong>â” ä½¿ç”¨æ•™å­¸ï¼š</strong>é–‹å•Ÿæ­¤ä»½ä½¿ç”¨æ•™å­¸</li>

                    <li><strong>ğŸ“‚ é–‹å•Ÿæ–°æª”/ç¯„ä¾‹ï¼š</strong>å›åˆ°ä¸Šå‚³ç•«é¢ï¼Œè®“ä½ å¯ä»¥è¼‰å…¥æ–°çš„æª”æ¡ˆæˆ–ç¯„ä¾‹ã€‚</li>
                    <li><strong>ğŸ’¾ ä¸‹è¼‰å­¸ç¿’ç´€éŒ„ï¼š</strong>æ ¹æ“šç•¶å‰çš„å­¸ç¿’ç‹€æ…‹ï¼Œä¸‹è¼‰æ‰€æœ‰å¡ç‰‡çš„åˆ—è¡¨ã€‚ä½ å¯ä»¥é¸æ“‡ <strong>.CSV</strong> æˆ– <strong>.TXT</strong> å…©ç¨®æ ¼å¼ã€‚</li>
                </ul>
                <p>å¸Œæœ›é€™ä»½æ•™å­¸èƒ½å¹«åŠ©ä½ é †åˆ©ä½¿ç”¨é€™å€‹å–®å­—å¡ç¨‹å¼ï¼ç¥ä½ å­¸ç¿’æ„‰å¿«ï¼</p>

                <!-- éš±è— -->
                <br>
                <div class="text-gray-400 dark:text-gray-600">
                    <p>v2.8.2 2025-09-01</p>
                </div>
            </div>
            <!-- æ•™å­¸å…§å®¹çµæŸ -->
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // DOM å…ƒç´ 
            const uploadScreen = document.getElementById('upload-screen');
            const mainScreen = document.getElementById('main-screen');
            const fileUpload = document.getElementById('file-upload');
            const exampleSelector = document.getElementById('example-selector');
            const loadSelectedExampleBtn = document.getElementById('load-selected-example-btn');
            const errorMessage = document.getElementById('error-message');
            const cardContainer = document.getElementById('card-container');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const correctBtn = document.getElementById('correct-btn');
            const incorrectBtn = document.getElementById('incorrect-btn');
            const deckInfo = document.getElementById('deck-info');
            const historyAlert = document.getElementById('history-alert');
            const menuBtn = document.getElementById('menu-btn');
            const closeMenuBtn = document.getElementById('close-menu-btn');
            const menuPanel = document.getElementById('menu-panel');
            const menuOverlay = document.getElementById('menu-overlay');
            const showAllBtn = document.getElementById('show-all-btn');
            const openNewBtn = document.getElementById('open-new-btn');
            const downloadBtn = document.getElementById('download-btn');
            const toggleLayoutBtn = document.getElementById('toggle-layout-btn');
            const toggleAutoRevealBtn = document.getElementById('toggle-auto-reveal-btn');
            const allCardsModal = document.getElementById('all-cards-modal');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const allCardsTable = document.getElementById('all-cards-table');
            const downloadModal = document.getElementById('download-modal');
            const closeDownloadModalBtn = document.getElementById('close-download-modal-btn');
            // æ–°å¢ï¼šæ•™å­¸èˆ‡å­—é«”å¤§å°ç›¸é—œå…ƒç´ 
            const howToUseBtn = document.getElementById('how-to-use-btn');
            const howToUseModal = document.getElementById('how-to-use-modal');
            const closeHowToUseModalBtn = document.getElementById('close-how-to-use-modal-btn');
            const fontSizeDecrease = document.getElementById('font-size-decrease');
            const fontSizeIncrease = document.getElementById('font-size-increase');
            const fontSizeValue = document.getElementById('font-size-value');


            // æ‡‰ç”¨ç¨‹å¼ç‹€æ…‹
            let fieldsPerCard = 0;
            let fullDeck = [];
            let learningDeck = [];
            let cardStatus = new Map();
            let history = [];
            let historyIndex = -1;
            const MAX_HISTORY = 20;
            let cardLayout = 'horizontal'; // 'horizontal' or 'vertical'
            let autoRevealFirstCard = false;
            // æ–°å¢ï¼šå­—é«”å¤§å°ç‹€æ…‹
            let cardFontSize = 2.5; // å–®ä½ç‚º rem
            const DEFAULT_FONT_SIZE = 2.5;
            const FONT_SIZE_STEP = 0.2;
            const MIN_FONT_SIZE = 1.0;
            const MAX_FONT_SIZE = 5.0;

            // --- å…§å»ºç¯„ä¾‹æª”æ¡ˆ ---
            const EXAMPLES = {
                'verbs': `æ‹œè¨ª;visit-visited-visited
è§€çœ‹;watch-watched-watched
ç©;play-played-played
æ´—ã€æ¼”å¥;wash-washed-washed
å–œæ­¡;like-liked-liked
æ„›;love-loved-loved
æ¨;hate-hated-hated
åœæ­¢;stop-stopped-stopped
è¨ˆç•«;plan-planned-planned
å“­æ³£;cry-cried-cried
å˜—è©¦;try-tried-tried
ç ”è®€;study-studied-studied
åƒ¹å€¼ã€èŠ±è²»;cost-cost-cost
åˆ‡ã€å‰²;cut-cut-cut
æ’ã€æ‰“;hit-hit-hit
å‚·å®³;hurt-hurt-hurt
è®“;let-let-let
æ”¾ç½®ã€æ¨¹ç«‹;put-put-put
è¨­ç½®;set-set-set
é–±è®€;read-read-read
æ‰“è³­;bet-bet-bet
é©åˆã€åˆèº«;fit-fit-fit
åœæ­¢ã€æ”¾æ£„;quit-quit-quit
ä¾†;come-came-come
è®Šæˆ;become-became-become
è·‘æ­¥;run-ran-run
å¸¶ä¾†;bring-brought-brought
è²·;buy-bought-bought
æƒ³ã€èªç‚º;think-thought-thought
æ‰“æ¶ã€çˆ­åµ;fight-fought-fought
æŠ“ã€æ¥ã€æŸ“ä¸Š;catch-caught-caught
æ•™æ›¸;teach-taught-taught
è¦ºå¾—;feel-felt-felt
ä¿æŒ;keep-kept-kept
ç¡è¦º;sleep-slept-slept
å“­æ³£;weep-wept-wept
é›¢é–‹;leave-left-left
å»ºé€ ;build-built-built
å€Ÿå‡º;lend-lent-lent
å¯„é€;send-sent-sent
ï¼ˆäººï¼‰èŠ±è²»;spend-spent-spent
æœ‰;have-had-had
åš;make-made-made
è¼¸æ‰;lose-lost-lost
è½è¦‹;hear-heard-heard
æ„æŒ‡;mean-meant-meant
ä»˜éŒ¢;pay-paid-paid
èªªï¼ˆçš„è©±ï¼‰;say-said-said
é¤µ;feed-fed-fed
é ˜å°;lead-led-led
é‡è¦‹;meet-met-met
æŒ–;dig-dug-dug
æ–æ“º;swing-swung-swung
æ‡¸åŠ;hang-hung-hung
ç™¼ç¾;find-found-found
å¾—åˆ°;get-got-gotten
å¿˜è¨˜;forget-forgot-forgotten
æ¡ä½ã€èˆ‰è¾¦;hold-held-held
å;sit-sat-sat
è³£å‡º;sell-sold-sold
å‘Šè¨´;tell-told-told
è´;win-won-won
ç«™ã€èµ·ç«‹;stand-stood-stood
äº†è§£;understand-understood-understood
èºº;lie-lay-lain
èªªè¬Š;lie-lied-lied
é–‹å§‹;begin-began-begun
å–;drink-drank-drunk
æŒ‰éˆ´;ring-rang-rung
å”±æ­Œ;sing-sang-sung
æ¸¸æ³³;swim-swam-swum
æ‰“ç ´;break-broke-broken
èªªã€è¬›è©±;speak-spoke-spoken
å·;steal-stole-stolen
é†’ä¾†;wake-woke-woken
å‡ºç”Ÿ;bear-bore-born
ç©¿ã€æˆ´;wear-wore-worn
åš;do-did-done
å»;go-went-gone
å’¬;bite-bit-bitten
èº²è—;hide-hid-hidden
é¨;ride-rode-ridden
å¯«;write-wrote-written
æ˜¯;be-was-were-been
è·Œå€’ã€æ‰è½;fall-fell-fallen
åƒ;eat-ate-eaten
é¸æ“‡;choose-chose-chosen
é–‹è»Š;drive-drove-driven
çµ¦;give-gave-given
æ–å‹•ã€éœ‡å‹•;shake-shook-shaken
æ‹¿èµ°ã€æ­ä¹˜;take-took-taken
çœ‹åˆ°;see-saw-seen
ç•«åœ–;draw-drew-drawn
å¹ã€çˆ†ç‚¸;blow-blew-blown
ç¨®ã€æˆé•·;grow-grew-grown
çŸ¥é“ã€èªè­˜;know-knew-known
ä¸Ÿ;throw-threw-thrown
é£›;fly-flew-flown
çµå‡;freeze-froze-frozen
åŸè«’;forgive-forgave-forgiven`,
                'elements':`æ°«;H
æ°¦;He
é‹°;Li
éˆ¹;Be
ç¡¼;B
ç¢³;C
æ°®;N
æ°§;O
æ°Ÿ;F
æ°–;Ne
éˆ‰;Na
é‚;Mg
é‹;Al
çŸ½;Si
ç£·;P
ç¡«;S
æ°¯;Cl
æ°¬;Ar
é‰€;K
éˆ£;Ca
éˆ§;Sc
éˆ¦;Ti
é‡©;V
é‰»;Cr
éŒ³;Mn
éµ;Fe
éˆ·;Co
é³;Ni
éŠ…;Cu
é‹…;Zn
éµ;Ga
éº;Ge
ç ·;As
ç¡’;Se
æº´;Br
æ°ª;Kr
éŠ£;Rb
é¶;Sr
é‡”;Y
é‹¯;Zr
éˆ®;Nb
é‰¬;Mo
é;Tc
é‡•;Ru
éŠ ;Rh
éˆ€;Pd
éŠ€;Ag
é˜;Cd
éŠ¦;In
éŒ«;Sn
éŠ»;Sb
ç¢²;Te
ç¢˜;I
æ°™;Xe
éŠ«;Cs
é‹‡;Ba
é‘­;La
éˆ°;Ce
é ;Pr
é‡¹;Nd
é‰•;Pm
é‡¤;Sm
éŠª;Eu
é‡“;Gd
é‹±;Tb
é‘;Dy
éˆ¥;Ho
é‰º;Er
éŠ©;Tm
é¿;Yb
é¦;Lu
é‰¿;Hf
é‰­;Ta
é¢;W
éŒ¸;Re
é‹¨;Os
éŠ¥;Ir
é‰‘;Pt
é‡‘;Au
æ±;Hg
é‰ˆ;Tl
é‰›;Pb
é‰;Bi
é‡™;Po
ç ˆ;At
æ°¡;Rn
é…;Fr
é³;Ra
éŒ’;Ac
é‡·;Th
é·;Pa
éˆ¾;U
é¿;Np
éˆ½;Pu
é‹‚;Am
é‹¦;Cm
é‰³;Bk
é‰²;Cf
é„;Es
é¨;Fm
é†;Md
é©;No
é’;Lr
é‘ª;Rf
ğ¨§€;Db
ğ¨­;Sg
ğ¨¨;Bh
ğ¨­†;Hs
ä¥‘;Mt
é½;Ds
éŒ€;Rg
é¶;Cn
é‰¨;Nh
éˆ‡;Fl
éŒ;Mc
é‰;Lv
é¿¬;Ts
é¿«;Og`,
                'capitals':`é˜¿çˆ¾åŠåˆ©äº;é˜¿çˆ¾åŠçˆ¾
å®‰å“¥æ‹‰;é­¯å®‰é”
è²å—;æ³¢å¤šè«¾ä¼
æ³¢æœ­é‚£;å˜‰æŸéš†é‡Œ
å¸ƒå‰ç´æ³•ç´¢;ç“¦åŠ æœå¤
è’²éš†åœ°;å‰ç‰¹åŠ 
å–€éº¥éš†;é›…æº«å¾·
ç¶­å¾·è§’;åŸ¹äº
ä¸­é;ç­åŸº
æŸ¥å¾·;æ©åŠ ç¾ç´
è‘›æ‘©;è«æ´›å°¼
æ°‘ä¸»å‰›æœ;é‡‘å¤æ²™
å‰›æœ;å¸ƒæ‹‰è–©å¸‚
è±¡ç‰™æµ·å²¸;é›…ç©†ç´¢æˆˆ
å‰å¸ƒåœ°;å‰å¸ƒåœ°å¸‚
åŸƒåŠ;é–‹ç¾…
èµ¤é“å¹¾å…§äº;é¦¬æ‹‰åš
å„åˆ©å‚äº;é˜¿æ–¯ç‘ªæ‹‰
è¡£ç´¢æ¯”äº;é˜¿è¿ªæ–¯é˜¿è²å·´
åŠ å½­;åˆ©ä¼¯ç¶­çˆ¾
ç”˜æ¯”äº;ç­ç«¹
åŠ ç´;é˜¿å…‹æ‹‰
å¹¾å…§äº;æŸ¯é‚£å…‹é‡Œ
å¹¾å…§äºæ¯”ç´¢;æ¯”ç´¹
è‚¯äº;å¥ˆæ´›æ¯”
è³´ç´¢æ‰˜;é¦¬è³½é­¯
è³´æ¯”ç‘äº;è’™ç¾…ç¶­äº
åˆ©æ¯”äº;çš„é»æ³¢é‡Œ
é¦¬é”åŠ æ–¯åŠ ;å®‰å¡”é‚£é‚£åˆ©ä½›
é¦¬æ‹‰å¨;é‡Œæœ—å¨
é¦¬åˆ©;å·´é¦¬ç§‘
èŒ…åˆ©å¡”å°¼äº;è«¾å…‹å°‘
æ¨¡é‡Œè¥¿æ–¯;è·¯æ˜“å£«æ¸¯
æ‘©æ´›å“¥;æ‹‰å·´ç‰¹
è«ä¸‰æ¯”å…‹;é¦¬å¸ƒå¤š
ç´ç±³æ¯”äº;æº«è·å…‹
å°¼æ—¥;å°¼é˜¿ç¾
å¥ˆåŠåˆ©äº;é˜¿å¸ƒåŠ 
ç›§å®‰é”;å‰ä½³åˆ©
è–å¤šç¾æ™®æ—è¥¿æ¯”;è–å¤šç¾
å¡å…§åŠ çˆ¾;é”å¡
å¡å¸­çˆ¾;ç¶­å¤šåˆ©äº
ç…å­å±±;å¼—é‡Œæ•¦
ç´¢é¦¬åˆ©äº;æ‘©åŠ è¿ªä¼‘
å—é;æ™®åˆ©æ‰˜åˆ©äº//é–‹æ™®æ•¦//å¸ƒéš†æ³‰
å—è˜‡ä¸¹;æœ±å·´
è˜‡ä¸¹;å–€åœŸç©†
å²ç“¦å¸å°¼;å¢¨å·´æœ¬//æ´›ç­å·´
å¦å°šå°¼äº;æœç¯¤ç‘ª
å¤šå“¥;æ´›ç¾
çªå°¼è¥¿äº;çªå°¼æ–¯å¸‚
çƒå¹²é”;åº·åŸ¹æ‹‰
å°šæ¯”äº;è·¯æ²™å¡
è¾›å·´å¨;å“ˆæ‹‰é›·
ç´¢é¦¬åˆ©è˜­;å“ˆçˆ¾æ ¼è–©
æ’’æ‹‰å¨é˜¿æ‹‰ä¼¯æ°‘ä¸»å…±å’Œåœ‹;é˜¿å°¤æ©
é˜¿å¯Œæ±—;å–€å¸ƒçˆ¾
äºç¾å°¼äº;è‘‰é‡Œæº«
äºå¡æ‹œç„¶;å·´åº«
å·´æ—;éº¥ç´ç‘ª
å­ŸåŠ æ‹‰;é”å¡
ä¸­è¯äººæ°‘å…±å’Œåœ‹;åŒ—äº¬
ä¸ä¸¹;è¾›å¸ƒ
æ±¶èŠ;æ–¯é‡Œå·´åŠ ç£
æŸ¬åŸ”å¯¨;é‡‘é‚Š
è³½æ™®å‹’æ–¯;å°¼æŸ¯è¥¿äº
å–¬æ²»äº;ææ¯”é‡Œæ–¯
å°åº¦;æ–°å¾·é‡Œ
å°åº¦å°¼è¥¿äº;é›…åŠ é”
ä¼Šæœ—;å¾·é»‘è˜­
ä¼Šæ‹‰å…‹;å·´æ ¼é”
ä»¥è‰²åˆ—;è€¶è·¯æ’’å†·
æ—¥æœ¬;æ±äº¬ï¼ˆäº‹å¯¦ä¸Šï¼‰
ç´„æ—¦;å®‰æ›¼
å“ˆè–©å…‹;é˜¿æ–¯å¡”ç´
æœé®®;å¹³å£¤
éŸ“åœ‹;é¦–çˆ¾
ç§‘å¨ç‰¹;ç§‘å¨ç‰¹åŸ
å‰çˆ¾å‰æ–¯;æ¯”æ–¯å‡±å…‹
å¯®åœ‹;æ°¸ç
é»å·´å«©;è²é­¯ç‰¹
é¦¬ä¾†è¥¿äº;å‰éš†å¡
é¦¬çˆ¾åœ°å¤«;é¦¬åˆ©
è’™å¤;çƒè˜­å·´æ‰˜
ç·¬ç”¸;å¥ˆæ¯”éƒ½
å°¼æ³Šçˆ¾;åŠ å¾·æ»¿éƒ½
é˜¿æ›¼;é¦¬æ–¯å–€ç‰¹
å·´åŸºæ–¯å¦;ä¼Šæ–¯è˜­ç‘ªå·´å¾·
è²å¾‹è³“;é¦¬å°¼æ‹‰
å¡é”;æœå“ˆ
æ²™çƒåœ°é˜¿æ‹‰ä¼¯;åˆ©é›…å¾·
æ–°åŠ å¡;æ–°åŠ å¡
æ–¯é‡Œè˜­å¡;æ–¯é‡Œè³ˆäºç“¦å¾·ç´æ™®æ‹‰ç§‘ç‰¹
æ•˜åˆ©äº;å¤§é¦¬å£«é©
å¡”å‰å…‹;æœå°šè²
æ³°åœ‹;æ›¼è°·
æ±å¸æ±¶;ç‹„åŠ›
åœŸè€³å…¶;å®‰å¡æ‹‰
åœŸåº«æ›¼;é˜¿ä»€å“ˆå·´ç‰¹
é˜¿æ‹‰ä¼¯è¯åˆå¤§å…¬åœ‹;é˜¿å¸ƒé”æ¯”
çƒèŒ²åˆ¥å…‹;å¡”ä»€å¹²
è¶Šå—;æ²³å…§
è‘‰é–€;æ²™é‚£
é˜¿å¸ƒå“ˆèŒ²;è˜‡å‘¼ç±³
åŒ—è³½æ™®å‹’æ–¯;å°¼æŸ¯è¥¿äº
å·´å‹’æ–¯å¦;è€¶è·¯æ’’å†·
ä¸­è¯æ°‘åœ‹;å—äº¬ï¼ˆè‡¨æ™‚åå®‰ï¼šè‡ºåŒ—ï¼‰
å—å¥§å¡æäº;èŒ²è¾›ç“¦åˆ©
é˜¿çˆ¾å·´å°¼äº;åœ°æ‹‰é‚£
å®‰é“çˆ¾;è€å®‰é“çˆ¾
å¥§åœ°åˆ©;ç¶­ä¹Ÿç´
ç™½ä¿„ç¾…æ–¯;æ˜æ–¯å…‹
æ¯”åˆ©æ™‚;å¸ƒé­¯å¡çˆ¾
æ³¢å£«å°¼äºèˆ‡èµ«å¡å“¥ç¶­ç´;å¡æ‹‰è€¶ä½›
ä¿åŠ åˆ©äº;ç´¢è²äº
å…‹ç¾…åŸƒè¥¿äº;æœ­æ ¼ç‘å¸ƒ
æ·å…‹;å¸ƒæ‹‰æ ¼
ä¸¹éº¥;å“¥æœ¬å“ˆæ ¹
æ„›æ²™å°¼äº;å¡”æ—
èŠ¬è˜­;èµ«çˆ¾è¾›åŸº
æ³•åœ‹;å·´é»
å¾·åœ‹;æŸæ—
å¸Œè‡˜;é›…å…¸
åŒˆç‰™åˆ©;å¸ƒé”ä½©æ–¯
å†°å³¶;é›·å…‹é›…ç¶­å…‹
æ„›çˆ¾è˜­;éƒ½æŸæ—
ç¾©å¤§åˆ©;ç¾…é¦¬
æ‹‰è„«ç¶­äº;é‡ŒåŠ 
åˆ—æ”¯æ•¦æ–¯ç™»;ç“¦éƒ½èŒ²
ç«‹é™¶å®›;ç¶­çˆ¾ç´æ–¯
ç›§æ£®å ¡;ç›§æ£®å ¡å¸‚
åŒ—é¦¬å…¶é “;å²é«˜æ¯”è€¶
é¦¬çˆ¾ä»–;ç“¦å‹’ä»–
æ‘©çˆ¾å¤šç“¦;å¥‡è¥¿ç‘™
æ‘©ç´å“¥;æ‘©ç´å“¥
è’™ç‰¹å…§å“¥ç¾…;æ³¢å¾·é‡ŒæŸ¥
è·è˜­;é˜¿å§†æ–¯ç‰¹ä¸¹
æŒªå¨;å¥§æ–¯é™¸
æ³¢è˜­;è¯æ²™
è‘¡è„ç‰™;é‡Œæ–¯æœ¬
ç¾…é¦¬å°¼äº;å¸ƒåŠ å‹’æ–¯ç‰¹
ä¿„ç¾…æ–¯;è«æ–¯ç§‘
è–é¦¬åˆ©è«¾;è–é¦¬åˆ©è«¾
å¡çˆ¾ç¶­äº;è²çˆ¾æ ¼å‹’
æ–¯æ´›ä¼å…‹;å¸ƒæ‹‰ææ–¯æ‹‰ç“¦
æ–¯æ´›ç¶­å°¼äº;ç›§æ¯”å®‰ç´
è¥¿ç­ç‰™;é¦¬å¾·é‡Œ
ç‘å…¸;æ–¯å¾·å“¥çˆ¾æ‘©
ç‘å£«;ä¼¯çˆ¾å°¼
çƒå…‹è˜­;åŸºè¼”
è‹±åœ‹;å€«æ•¦
æ¢µè’‚å²¡;æ¢µè’‚å²¡
ç§‘ç´¢æ²ƒ;æ™®é‡Œæ–¯æç´
è¶æ–¯ç‰¹æ²³æ²¿å²¸;ææ‹‰æ–¯æµ¦
å®‰åœ°å¡åŠå·´å¸ƒé”;è–ç´„ç¿°æ–¯
å·´å“ˆé¦¬;æ‹¿é¨·
å·´è²å¤š;å¸ƒé‡Œå¥‡æ•¦
è²é‡Œæ–¯;è²çˆ¾å¢¨é‚¦
åŠ æ‹¿å¤§;æ¸¥å¤ªè¯
å“¥æ–¯å¤§é»åŠ ;è–è·è¥¿
å¤å·´;å“ˆç“¦é‚£
å¤šç±³å°¼å…‹;ç¾…æ¢­
å¤šæ˜å°¼åŠ ;è–å¤šæ˜å“¥
è–©çˆ¾ç“¦å¤š;è–è–©çˆ¾ç“¦å¤š
æ ¼ç‘é‚£é”;è–å–¬æ²»
ç“œåœ°é¦¬æ‹‰;ç“œåœ°é¦¬æ‹‰å¸‚
æµ·åœ°;å¤ªå­æ¸¯
å®éƒ½æ‹‰æ–¯;å¾·å¤è¥¿åŠ å·´
ç‰™è²·åŠ ;äº¬æ–¯æ•¦
å¢¨è¥¿å“¥;å¢¨è¥¿å“¥åŸ
å°¼åŠ æ‹‰ç“œ;é¦¬ç´ç“œ
å·´æ‹¿é¦¬;å·´æ‹¿é¦¬åŸ
è–å…‹é‡Œæ–¯å¤šç¦åŠå°¼ç¶­æ–¯;å·´å£«åº• (è–å…‹é‡Œæ–¯å¤šç¦åŠå°¼ç¶­æ–¯)
è–éœ²è¥¿äº;å¡æ–¯ç¿ 
è–æ–‡æ£®åŠæ ¼ç‘é‚£ä¸;é‡‘çŸ³åŸ
åƒé‡Œé”åŠæ‰˜å·´å“¥;è¥¿ç­ç‰™æ¸¯
ç¾åœ‹;è¯ç››é “å“¥å€«æ¯”äºç‰¹å€
é˜¿æ ¹å»·;å¸ƒå®œè«¾æ–¯è‰¾åˆ©æ–¯
ç»åˆ©ç¶­äº;è˜‡å…‹ç‘
å·´è¥¿;å·´è¥¿åˆ©äº
æ™ºåˆ©;è–åœ°ç‰™å“¥
å“¥å€«æ¯”äº;æ³¢å“¥å¤§
å„ç“œå¤š;åŸºå¤š
è“‹äºé‚£;å–¬æ²»åŸ
å·´æ‹‰åœ­;äºæ¾æ£®
ç§˜é­¯;åˆ©é¦¬
è˜‡åˆ©å—;å·´æ‹‰é¦¬åˆ©æ³¢
çƒæ‹‰åœ­;è’™ç‰¹ç¶­å¤š
å§”å…§ç‘æ‹‰;å¡æ‹‰å¡æ–¯
æ¾³å¤§åˆ©äº;ååŸ¹æ‹‰
åº«å…‹ç¾¤å³¶;é˜¿ç“¦é­¯
æ–æ¿Ÿ;è˜‡ç“¦
å‰é‡Œå·´æ–¯;å—å¡”æ‹‰ç“¦
é¦¬ç´¹çˆ¾ç¾¤å³¶;é¦¬ä¹…ç¾…
å¯†å…‹ç¾…å°¼è¥¿äº;å¸•é‡Œå…‹çˆ¾
è«¾é­¯;äºå€«
ç´è¥¿è˜­;å¨éˆé “
ç´åŸƒ;é˜¿æ´›è²
å¸›ç‰;æ©å‰é­¯ç©†å¾·
å·´å¸ƒäºç´å¹¾å…§äº;æ‘©æ–¯æ¯”æ¸¯
è–©æ‘©äº;é˜¿åº‡äº
ç´¢ç¾…é–€ç¾¤å³¶;è·å°¼é˜¿æ‹‰
æ±åŠ ;åŠªç“œå©ç™¼
åç“¦é­¯;ç¦ç´ä½›æ
è¬é‚£æœ;ç¶­æ‹‰æ¸¯`
            };

            // --- äº‹ä»¶ç›£è½ ---
            fileUpload.addEventListener('change', handleFileUpload);
            loadSelectedExampleBtn.addEventListener('click', () => {
                const selectedKey = exampleSelector.value;
                if (selectedKey && EXAMPLES[selectedKey]) {
                    loadData(EXAMPLES[selectedKey]);
                } else {
                    showError("è«‹å¾ä¸‹æ‹‰é¸å–®ä¸­é¸æ“‡ä¸€å€‹ç¯„ä¾‹ã€‚");
                }
            });

            prevBtn.addEventListener('click', showPrevCard);
            nextBtn.addEventListener('click', () => showNextCard('unjudged'));
            correctBtn.addEventListener('click', () => showNextCard('correct'));
            incorrectBtn.addEventListener('click', () => showNextCard('incorrect'));
            mainScreen.addEventListener('click', (e) => { if (e.target === mainScreen) { showNextCard('unjudged'); } });
            menuBtn.addEventListener('click', toggleMenu);
            closeMenuBtn.addEventListener('click', toggleMenu);
            menuOverlay.addEventListener('click', toggleMenu);
            showAllBtn.addEventListener('click', showAllCardsView);
            openNewBtn.addEventListener('click', () => { backToUploadScreen(); toggleMenu(); });
            downloadBtn.addEventListener('click', () => { downloadModal.classList.remove('hidden'); toggleMenu(); });
            toggleLayoutBtn.addEventListener('click', toggleCardLayout);
            toggleAutoRevealBtn.addEventListener('click', toggleAutoReveal);
            closeModalBtn.addEventListener('click', () => allCardsModal.classList.add('hidden'));
            closeDownloadModalBtn.addEventListener('click', () => downloadModal.classList.add('hidden'));
            document.querySelectorAll('.download-format-btn').forEach(btn => {
                btn.addEventListener('click', (e) => downloadData(e.target.dataset.format));
            });
            // æ–°å¢ï¼šæ•™å­¸èˆ‡å­—é«”å¤§å°äº‹ä»¶ç›£è½
            howToUseBtn.addEventListener('click', () => { howToUseModal.classList.remove('hidden'); toggleMenu(); });
            closeHowToUseModalBtn.addEventListener('click', () => { howToUseModal.classList.add('hidden'); });
            fontSizeIncrease.addEventListener('click', () => {
                if (cardFontSize < MAX_FONT_SIZE) {
                    cardFontSize = Math.min(MAX_FONT_SIZE, cardFontSize + FONT_SIZE_STEP);
                    updateCardFontSize();
                }
            });
            fontSizeDecrease.addEventListener('click', () => {
                if (cardFontSize > MIN_FONT_SIZE) {
                    cardFontSize = Math.max(MIN_FONT_SIZE, cardFontSize - FONT_SIZE_STEP);
                    updateCardFontSize();
                }
            });

            // --- æ ¸å¿ƒåŠŸèƒ½ ---
            function loadData(content) {
                try {
                    parseFileContent(content);
                    startGame();
                } catch (error) {
                    showError(error.message);
                    resetApp();
                }
            }
            
            function handleFileUpload(event) {
                const file = event.target.files[0];
                if (!file || !file.name.endsWith('.txt')) { showError("è«‹é¸æ“‡ä¸€å€‹ .txt æª”æ¡ˆã€‚"); return; }
                const reader = new FileReader();
                reader.onload = (e) => { loadData(e.target.result); };
                reader.onerror = () => { showError("è®€å–æª”æ¡ˆæ™‚ç™¼ç”ŸéŒ¯èª¤ã€‚"); resetApp(); };
                reader.readAsText(file);
            }
            
            function parseFileContent(content) {
                const lines = content.split('\n').map(line => line.trim()).filter(line => line.length > 0);
                if (lines.length === 0) throw new Error("æª”æ¡ˆç‚ºç©ºæˆ–æ ¼å¼ä¸æ­£ç¢ºã€‚");
                fieldsPerCard = lines[0].split(';').length;
                if (fieldsPerCard < 1) throw new Error("æª”æ¡ˆæ ¼å¼éŒ¯èª¤ï¼Œæ¯è¡Œè‡³å°‘éœ€æœ‰ä¸€å€‹æ¬„ä½ã€‚");
                fullDeck = lines.map((line, index) => {
                    const fields = line.split(';');
                    if (fields.length !== fieldsPerCard) throw new Error(`æª”æ¡ˆæ ¼å¼éŒ¯èª¤ï¼šç¬¬ ${index + 1} è¡Œé è¨ˆæœ‰ ${fieldsPerCard} å€‹æ¬„ä½ï¼Œä½†å¯¦éš›æœ‰ ${fields.length} å€‹ã€‚`);
                    return fields.map(field => field.trim().replace(/\/\//g, '<br>'));
                });
            }

            function startGame() {
                cardStatus.clear();
                fullDeck.forEach(cardData => { cardStatus.set(JSON.stringify(cardData), 'unseen'); });
                learningDeck = [...fullDeck];
                shuffleDeck(learningDeck);
                uploadScreen.classList.add('hidden');
                mainScreen.classList.remove('hidden');
                mainScreen.classList.add('flex');
                history = [];
                historyIndex = -1;
                resetFontSize();
                showNextCard('new_game');
            }
            
            function restartGame() {
                fullDeck.forEach(cardData => { cardStatus.set(JSON.stringify(cardData), 'unseen'); });
                learningDeck = [...fullDeck];
                shuffleDeck(learningDeck);
                history = [];
                historyIndex = -1;
                [prevBtn, nextBtn, correctBtn, incorrectBtn].forEach(btn => btn.disabled = false);
                resetFontSize();
                showNextCard('new_game');
            }

            function showNextCard(action) {
                if (historyIndex >= 0 && historyIndex < history.length) {
                    const currentCardData = history[historyIndex];
                    const cardKey = JSON.stringify(currentCardData);
                    if (action === 'correct') {
                        cardStatus.set(cardKey, 'correct');
                        learningDeck = learningDeck.filter(cardData => JSON.stringify(cardData) !== cardKey);
                    } else if (action === 'incorrect') { cardStatus.set(cardKey, 'incorrect'); }
                }

                let nextCardData;
                if (historyIndex < history.length - 1) {
                    historyIndex++;
                    nextCardData = history[historyIndex];
                } else {
                    if (learningDeck.length === 0) { displayEndOfDeck(); return; }
                    const randomIndex = Math.floor(Math.random() * learningDeck.length);
                    nextCardData = learningDeck[randomIndex];
                    history.push(nextCardData);
                    if (history.length > MAX_HISTORY) { history.shift(); }
                    historyIndex = history.length - 1;
                }
                
                const nextCardKey = JSON.stringify(nextCardData);
                if (cardStatus.get(nextCardKey) === 'unseen') { cardStatus.set(nextCardKey, 'unjudged'); }
                displayCardGroup(nextCardData);
                updateUI();
            }

            function showPrevCard() {
                if (historyIndex > 0) {
                    historyIndex--;
                    displayCardGroup(history[historyIndex]);
                } else {
                    historyAlert.classList.remove('hidden');
                    setTimeout(() => historyAlert.classList.add('hidden'), 1500);
                }
                updateUI();
            }

            function displayCardGroup(cardData) {
                cardContainer.innerHTML = '';
                const layouts = {
                    horizontal: { 1: 'grid-cols-1 grid-rows-1', 2: 'grid-cols-2 grid-rows-1', 3: 'grid-cols-3 grid-rows-1', 4: 'grid-cols-4 grid-rows-1', 5: 'grid-cols-5 grid-rows-1', 6: 'grid-cols-3 grid-rows-2' },
                    vertical: { 1: 'grid-cols-1 grid-rows-1', 2: 'grid-cols-1 grid-rows-2', 3: 'grid-cols-1 grid-rows-3', 4: 'grid-cols-1 grid-rows-4', 5: 'grid-cols-2 grid-rows-3', 6: 'grid-cols-2 grid-rows-3' }
                };
                cardContainer.className = `grid gap-2 w-full h-full ${layouts[cardLayout][fieldsPerCard] || 'grid-cols-2 grid-rows-2'}`;

                cardData.forEach(content => {
                    const card = document.createElement('div');
                    card.className = 'card bg-white dark:bg-gray-700 rounded-xl shadow-md flex items-center justify-center p-4 text-center cursor-pointer transition-transform transform hover:scale-105';
                    card.innerHTML = `<span class="placeholder text-5xl text-gray-400 dark:text-gray-500">?</span><div class="content">${content}</div>`;
                    card.addEventListener('click', (e) => { e.stopPropagation(); card.classList.toggle('revealed'); });
                    cardContainer.appendChild(card);
                });

                updateCardFontSize(); // å¥—ç”¨ç•¶å‰å­—é«”å¤§å°

                if (autoRevealFirstCard) {
                    const firstCard = cardContainer.querySelector('.card');
                    if (firstCard) firstCard.classList.add('revealed');
                }
            }

            function displayEndOfDeck() {
                cardContainer.innerHTML = `<div class="col-span-full row-span-full flex flex-col items-center justify-center text-center p-8 bg-white dark:bg-gray-700 rounded-xl"><h2 class="text-3xl font-bold mb-4">ğŸ‰ æ­å–œï¼</h2><p class="text-xl">æ‚¨å·²å­¸æœƒæ‰€æœ‰å¡ç‰‡ï¼</p><button id="restart-btn" class="mt-8 px-6 py-3 bg-blue-500 text-white font-semibold rounded-lg shadow-md hover:bg-blue-600 transition-colors">é‡æ–°é–‹å§‹</button></div>`;
                document.getElementById('restart-btn').addEventListener('click', restartGame);
                [prevBtn, nextBtn, correctBtn, incorrectBtn].forEach(btn => btn.disabled = true);
                deckInfo.textContent = 'å®Œæˆ!';
            }

            function updateUI() {
                prevBtn.disabled = historyIndex <= 0;
                nextBtn.disabled = learningDeck.length === 0 && historyIndex === history.length - 1;
                deckInfo.textContent = `å¾…å­¸ç¿’: ${learningDeck.length} çµ„`;
            }
            
            // --- é¸å–®å’Œ Modal åŠŸèƒ½ ---
            function toggleMenu() {
                menuPanel.classList.toggle('open');
                menuPanel.classList.toggle('closed');
                menuOverlay.classList.toggle('hidden');
            }
            
            function toggleCardLayout() {
                cardLayout = (cardLayout === 'horizontal') ? 'vertical' : 'horizontal';
                if (history.length > 0) displayCardGroup(history[historyIndex]);
                toggleMenu();
            }

            function toggleAutoReveal() {
                autoRevealFirstCard = !autoRevealFirstCard;
                const statusSpan = toggleAutoRevealBtn.querySelector('span');
                if (autoRevealFirstCard) {
                    statusSpan.textContent = 'é–‹';
                    statusSpan.className = 'font-bold text-green-500';
                } else {
                    statusSpan.textContent = 'é—œ';
                    statusSpan.className = 'font-bold text-red-500';
                }
            }
            
            function backToUploadScreen() {
                resetApp();
                mainScreen.classList.add('hidden');
                mainScreen.classList.remove('flex');
                uploadScreen.classList.remove('hidden');
                errorMessage.textContent = '';
            }

            function showAllCardsView() {
                allCardsModal.classList.remove('hidden');
                toggleMenu();
                const statusIcons = { correct: 'âœ…', incorrect: 'âŒ', unjudged: 'â¬œ', unseen: 'â¬œ' };
                let tableHTML = '<thead><tr class="border-b border-gray-200 dark:border-gray-600"><th class="p-2">ç‹€æ…‹</th>';
                for (let i = 1; i <= fieldsPerCard; i++) { tableHTML += `<th class="p-2">å¡ç‰‡ ${i}</th>`; }
                tableHTML += '</tr></thead><tbody>';
                fullDeck.forEach(cardData => {
                    const key = JSON.stringify(cardData);
                    const status = cardStatus.get(key) || 'unseen';
                    tableHTML += `<tr class="border-b border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-900"><td class="p-2 text-center">${statusIcons[status]}</td>`;
                    cardData.forEach(field => { tableHTML += `<td class="p-2">${field.replace(/<br>/g, ' ')}</td>`; });
                    tableHTML += '</tr>';
                });
                tableHTML += '</tbody>';
                allCardsTable.innerHTML = tableHTML;
            }
            
            // --- ä¸‹è¼‰åŠŸèƒ½ ---
            function getCleanData() {
                const statusIcons = { correct: 'âœ…', incorrect: 'âŒ', unjudged: 'â¬œ', unseen: 'â¬œ' };
                const headers = ['ç‹€æ…‹', ...Array.from({ length: fieldsPerCard }, (_, i) => `å¡ç‰‡ ${i + 1}`)];
                const rows = fullDeck.map(cardData => {
                    const key = JSON.stringify(cardData);
                    const status = cardStatus.get(key) || 'unseen';
                    return [statusIcons[status], ...cardData.map(field => field.replace(/<br>/g, ' ').replace(/\s+/g, ' ').trim())];
                });
                return { headers, rows };
            }

            function downloadData(format) {
                const { headers, rows } = getCleanData();
                const filename = `card_data_${new Date().toISOString().slice(0,10)}`;
                
                if (format === 'csv') {
                    let csvContent = "data:text/csv;charset=utf-8,\uFEFF";
                    csvContent += headers.join(',') + '\r\n';
                    rows.forEach(row => {
                        const rowData = row.map(field => `"${String(field).replace(/"/g, '""')}"`);
                        csvContent += rowData.join(',') + '\r\n';
                    });
                    triggerDownload(encodeURI(csvContent), `${filename}.csv`);
                } else if (format === 'txt') {
                    let txtContent = headers.join('\t') + '\r\n';
                    rows.forEach(row => { txtContent += row.join('\t') + '\r\n'; });
                    const blob = new Blob([txtContent], { type: 'text/plain;charset=utf-8,' });
                    triggerDownload(URL.createObjectURL(blob), `${filename}.txt`);
                }
                downloadModal.classList.add('hidden');
            }

            function triggerDownload(uri, filename) {
                const link = document.createElement("a");
                link.href = uri;
                link.download = filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }

            // --- è¼”åŠ©åŠŸèƒ½ ---
            // æ–°å¢ï¼šæ›´æ–°å¡ç‰‡å­—é«”å¤§å°çš„å‡½å¼
            function updateCardFontSize() {
                const cards = document.querySelectorAll('#card-container .card');
                const newSize = `${cardFontSize.toFixed(1)}rem`;
                cards.forEach(card => {
                    card.style.fontSize = newSize;
                });
                fontSizeValue.textContent = newSize;
            }
            
            // æ–°å¢ï¼šé‡è¨­å­—é«”å¤§å°çš„å‡½å¼
            function resetFontSize() {
                cardFontSize = DEFAULT_FONT_SIZE;
                fontSizeValue.textContent = 'é è¨­';
                updateCardFontSize();
            }

            function shuffleDeck(deckToShuffle) {
                for (let i = deckToShuffle.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [deckToShuffle[i], deckToShuffle[j]] = [deckToShuffle[j], deckToShuffle[i]]; }
            }
            function showError(message) { errorMessage.textContent = message; }
            function resetApp() {
                fullDeck = []; learningDeck = []; cardStatus.clear(); history = []; historyIndex = -1; fieldsPerCard = 0; fileUpload.value = '';
            }
        });
    </script>
</body>
</html>
